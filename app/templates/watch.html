{% extends 'base.html' %}

{% block page_content %}
<script src=" {{ url_for('static', filename='js/videoPlayerActions.js') }}"></script>
<script src=" {{ url_for('static', filename='js/commentActions.js') }}"></script>
<div class="watchLeftColumn">
  <video class='videoPlayer' controls>
    <source src="{{ video.file_url }}" type='video/mp4'>
    Your browser does not support the video tag
  </video>

  <div class='videoInfo'>
    <h1>{{ video.title }}</h1>

    <div class='bottomSection'>
        <span class='viewCount'>{{ video.num_views }} views</span>
        <div class='controls'>
          <button class='likeButton' onclick="likeVideo(this, {{ video.id }})">
            {% if video.liked_by.filter_by(user_id=current_user.id).first() %}
            <img src="{{ url_for('static', filename='images/icons/thumb-up-active.png') }}">
            {% else %}
            <img src="{{ url_for('static', filename='images/icons/thumb-up.png') }}">
            {% endif %}
            <span class='text'>{{ video.liked_by.count() }}</span>
          </button>

          <button class='dislikeButton' onclick="dislikeVideo(this, {{ video.id }})">
            {% if video.disliked_by.filter_by(user_id=current_user.id).first() %}
            <img src="{{ url_for('static', filename='images/icons/thumb-down-active.png') }}">
            {% else %}
            <img src="{{ url_for('static', filename='images/icons/thumb-down.png') }}">
            {% endif %}
            <span class='text'>{{ video.disliked_by.count() }}</span>
          </button>
        </div>
    </div>
  </div>

  <div class='secondaryInfo'>
    <div class='topRow'>
      <a href="{{ url_for('page.profile', username=video.user.username) }}">
        <img src="{{ url_for('static', filename='images/profilePictures/default.png') }}" class='profilePicture'>
      </a>

      <div class='uploadInfo'>
        <span class='owner'>
          <a href='#'>
          {{ video.user.username }}
          </a>
        </span>
        <span class='date'>{{ video.created_at }}</span>
      </div>
        <!-- edit or subscribe -->
        {% if current_user.username == video.user.username %}
        <div class='editVideoButtonContainer'>
          <a href='#'>
            <button class='edit button'>
                <span class='text'>EDIT VIDEO</span>
            </button>
          </a>
        </div>
        {% else %}
        <div class='subscribeButtonContainer'>
          <button class='subscribe button' onclick=''>
            <span class='text'>SUBSCRIBE</span>
          </button>
        </div>
        {% endif %}
    </div>

    <div class='descriptionContainer'>
        {{ video.description }}
    </div>
  </div>

  <div class='commentSection'>

    <div class='header'>
        <span class='commentCount'>{{ video.comments.count() }} Comments</span>

        <div class='commentForm'>
          <a href="{{ url_for('page.profile', username=current_user.username) }}">
            <img src="{{ url_for('static', filename='images/profilePictures/default.png') }}" class='profilePicture'>
          </a>
          <textarea class='commentBodyClass' placeholder='Add a public comment'></textarea>
          <button class='postComment' onclick="postComment(this, {{ current_user.id }}, {{ video.id }}, null, 'comments')">
            <span class='text'>COMMENT</span>
          </button>
        </div>
    </div>

    <div class='comments'>
      {% for comment in video.comments %}
      <div class='itemContainer'>
        <div class='comment'>
          $profileButton

          <div class='mainContainer'>

            <div class='commentHeader'>
              <a href='profile.php?username=$postedBy'>
                <span class='username'>$postedBy</span>
              </a>
              <span class='timestamp'>$timespan</span>
            </div>

            <div class='body'>
              $body
            </div>
          </div>

        </div>
        $commentControls
        $viewRepliesText
      </div>
      {% endfor %}
    </div>

  </div>
</div>

<div class="suggestions">
  <!-- suggestion videos -->
  
</div>
{% endblock %}
